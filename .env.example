# Environment Configuration Template
# Copy this file to .env and fill in your values
# DO NOT commit .env to version control

# =============================================================================
# ENVIRONMENT
# =============================================================================
ENVIRONMENT=development  # development, staging, production
DEBUG=true
LOG_LEVEL=info  # debug, info, warning, error, critical

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_STREAM_MAX_LEN=10000
REDIS_STREAM_RETENTION_DAYS=7
REDIS_CONSUMER_BLOCK_MS=1000
REDIS_POOL_MAX_CONNECTIONS=50

# =============================================================================
# FASTAPI BACKEND
# =============================================================================
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
BACKEND_WORKERS=4
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
API_V1_PREFIX=/api/v1
WEBSOCKET_PING_INTERVAL=30
WEBSOCKET_PING_TIMEOUT=10

# =============================================================================
# gRPC SERVICES
# =============================================================================
GRPC_STT_HOST=localhost
GRPC_STT_PORT=50051
GRPC_NLP_HOST=localhost
GRPC_NLP_PORT=50052
GRPC_SUMMARY_HOST=localhost
GRPC_SUMMARY_PORT=50053
GRPC_MAX_WORKERS=10
GRPC_KEEPALIVE_TIME_MS=60000
GRPC_KEEPALIVE_TIMEOUT_MS=20000

# =============================================================================
# AUDIO CAPTURE (Windows WASAPI)
# =============================================================================
AUDIO_SAMPLE_RATE=48000
AUDIO_CHANNELS=1  # 1=Mono, 2=Stereo
AUDIO_BIT_DEPTH=16
AUDIO_CHUNK_DURATION_MS=100
AUDIO_BUFFER_SIZE_SECONDS=10
AUDIO_DEVICE_ID=  # Leave empty for system default
AUDIO_DEVICE_TYPE=loopback  # input, output, loopback

# =============================================================================
# VOICE ACTIVITY DETECTION (Silero VAD)
# =============================================================================
VAD_THRESHOLD=0.5  # 0.0-1.0
VAD_MIN_SPEECH_DURATION_MS=250
VAD_MIN_SILENCE_DURATION_MS=100
VAD_PADDING_DURATION_MS=30
VAD_MODEL_PATH=models/silero_vad.jit

# =============================================================================
# STT ENGINE (Whisper)
# =============================================================================
STT_MODEL_NAME=whisper-large-v3
STT_MODEL_PATH=models/whisper
STT_DEVICE=cuda  # cuda, cpu
STT_COMPUTE_TYPE=float16  # float16, int8, int8_float16
STT_BEAM_SIZE=5
STT_BEST_OF=5
STT_LANGUAGE=auto  # auto, en, es, fr, de, etc.
STT_TEMPERATURE=0.0
STT_VAD_FILTER=true
STT_VAD_THRESHOLD=0.5
STT_MAX_WORKERS=2

# =============================================================================
# NLP INSIGHTS
# =============================================================================
NLP_DEVICE=cuda  # cuda, cpu
NLP_MODEL_MISTRAL=mistralai/Mistral-7B-Instruct-v0.2
NLP_MODEL_SENTENCE_BERT=all-MiniLM-L6-v2
NLP_KEYWORDS_TOP_N=10
NLP_KEYWORDS_MIN_NGRAM=1
NLP_KEYWORDS_MAX_NGRAM=3
NLP_DIARIZATION_MODEL=pyannote/speaker-diarization-3.1
NLP_DIARIZATION_MIN_SPEAKERS=1
NLP_DIARIZATION_MAX_SPEAKERS=10

# =============================================================================
# SUMMARY GENERATOR
# =============================================================================
SUMMARY_DEVICE=cuda  # cuda, cpu
SUMMARY_MODEL=meta-llama/Llama-3.2-8B
SUMMARY_MODEL_8BIT=true  # Use 8-bit quantization (reduces memory from ~15GB to ~8GB)
SUMMARY_MAX_LENGTH=150
SUMMARY_MIN_LENGTH=30
SUMMARY_STYLE=concise  # concise, detailed, bullet_points
SUMMARY_TEMPERATURE=0.7
SUMMARY_TOP_P=0.9
SUMMARY_SLIDING_WINDOW=512

# =============================================================================
# GPU CONFIGURATION
# =============================================================================
CUDA_VISIBLE_DEVICES=0  # GPU device ID(s), comma-separated
CUDA_DEVICE_ORDER=PCI_BUS_ID
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512
TENSORRT_CACHE_DIR=models/tensorrt_cache
GPU_MEMORY_FRACTION=0.9  # Reserve 90% GPU memory

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================
MAX_CONCURRENT_SESSIONS=10
SESSION_TIMEOUT_SECONDS=3600
TRANSCRIPTION_QUEUE_SIZE=100
NLP_QUEUE_SIZE=50
SUMMARY_QUEUE_SIZE=20
WORKER_THREAD_POOL_SIZE=8

# =============================================================================
# MONITORING & METRICS
# =============================================================================
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=8001
METRICS_EXPORT_INTERVAL_SECONDS=15
TELEMETRY_EXPORT_ORCHIDEA=true
ORCHIDEA_METRICS_PATH=telemetry/orchidea

# =============================================================================
# LOGGING
# =============================================================================
LOG_FORMAT=json  # json, text
LOG_FILE=logs/rtstt.log
LOG_ROTATION=1 day
LOG_RETENTION=30 days
LOG_MAX_SIZE=100MB

# =============================================================================
# STORAGE
# =============================================================================
SESSIONS_STORAGE_PATH=sessions/
TRANSCRIPTS_STORAGE_PATH=transcripts/
SUMMARIES_STORAGE_PATH=summaries/
TEMP_STORAGE_PATH=tmp/
AUTO_CLEANUP_ENABLED=true
CLEANUP_AFTER_DAYS=7

# =============================================================================
# SECURITY
# =============================================================================
API_KEY=  # Optional API key for authentication
JWT_SECRET_KEY=  # Generate with: openssl rand -hex 32
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=1440
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60

# =============================================================================
# ORCHIDEA FRAMEWORK
# =============================================================================
ORCHIDEA_VERSION=1.3
ORCHIDEA_MASTER_MODEL=claude-opus-4.1
ORCHIDEA_TEAM_MODEL=claude-sonnet-3.5
ORCHIDEA_SUPPORT_MODEL=claude-haiku
ORCHIDEA_QUALITY_GATE_THRESHOLD=0.99
ORCHIDEA_PUII_MIN_ALIGNMENT=0.6
ORCHIDEA_MAX_HUMAN_INTERVENTIONS=5
ORCHIDEA_VALIDATION_REQUIRED=true

# =============================================================================
# DEVELOPMENT TOOLS
# =============================================================================
RELOAD_ON_CHANGE=true  # Auto-reload on file changes (dev only)
PROFILING_ENABLED=false
DEBUG_TOOLBAR_ENABLED=false
MOCK_AUDIO_INPUT=false  # Use mock audio for testing

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================
COMPOSE_PROJECT_NAME=rtstt
DOCKER_BUILDKIT=1
COMPOSE_DOCKER_CLI_BUILD=1

# =============================================================================
# FRONTEND (Electron)
# =============================================================================
FRONTEND_DEV_SERVER_PORT=5173
ELECTRON_ENABLE_LOGGING=true
AUTO_UPDATE_ENABLED=false
AUTO_UPDATE_URL=
